Sub FormatWorksheet()
    Dim ws As Worksheet
    Dim rng As Range
    Dim cell As Range
    Dim blankCells As Range

    For Each ws In ThisWorkbook.Worksheets
        ' Remove the first 8 rows
        ws.Rows("1:8").Delete

        ' Update the first row with specific headings
        ws.Range("A1").Value = "A1"
        ws.Range("B1").Value = "B1"
        ws.Range("C1").Value = "C1"
        ws.Range("D1").Value = "D1"
        ws.Range("E1").Value = "E1"

        ' Unmerge all cells
        ws.Cells.UnMerge

        ' Unwrap text in all cells
        ws.Cells.WrapText = False

        ' Remove underline from texts in all cells
        For Each rng In ws.UsedRange
            rng.Font.Underline = False
        Next rng

        ' Replace all cells in column C that do not contain "Name" with "-"
        For Each cell In ws.Range("C1:C" & ws.Cells(Rows.Count, "C").End(xlUp).Row)
            If InStr(cell.Value, "Name") = 0 Then
                cell.Value = "-"
            End If
        Next cell

        ' Replace all blank cells in the range A1 to R1910 with "-"
        On Error Resume Next ' In case there are no blank cells
        Set blankCells = ws.Range("A1:R1910").SpecialCells(xlCellTypeBlanks)
        On Error GoTo 0
        If Not blankCells Is Nothing Then
            blankCells.Value = "-"
        End If

        ' Copy all cells from column C starting from C3 to column B starting from B2
        ws.Range("C3:C" & ws.Cells(Rows.Count, "C").End(xlUp).Row).Copy Destination:=ws.Range("B2")

        ' Resize all the cells to fit the content
        ws.Cells.EntireColumn.AutoFit
        ws.Cells.EntireRow.AutoFit
    Next ws
End Sub
