Sub FormatWorksheet()
    Dim ws As Worksheet
    Dim rng As Range
    Dim cell As Range
    Dim blankCells As Range
    Dim sourceCell As Range
    Dim destinationCell As Range
    Dim sourceCellI As Range
    Dim sourceCellI2 As Range

    For Each ws In ThisWorkbook.Worksheets
        ' Remove the first 8 rows
        ws.Rows("1:8").Delete

        ' Update the first row with specific headings
        ws.Range("A1").Value = "A1"
        ws.Range("B1").Value = "B1"
        ws.Range("C1").Value = "C1"
        ws.Range("D1").Value = "D1"
        ws.Range("E1").Value = "E1"

        ' Unmerge all cells
        ws.Cells.UnMerge

        ' Unwrap text in all cells
        ws.Cells.WrapText = False

        ' Remove underline from texts in all cells
        For Each rng In ws.UsedRange
            rng.Font.Underline = False
        Next rng

        ' Replace all cells in column C that do not contain "Name" with "-"
        For Each cell In ws.Range("C1:C" & ws.Cells(Rows.Count, "C").End(xlUp).Row)
            If InStr(cell.Value, "Name") = 0 Then
                cell.Value = "-"
            End If
        Next cell

        ' Replace all blank cells in the range A1 to R1910 with "-"
        On Error Resume Next ' In case there are no blank cells
        Set blankCells = ws.Range("A1:R1910").SpecialCells(xlCellTypeBlanks)
        On Error GoTo 0
        If Not blankCells Is Nothing Then
            blankCells.Value = "-"
        End If

        ' Copy all cells from column C starting from C3 to column B starting from B2
        ws.Range("C3:C" & ws.Cells(Rows.Count, "C").End(xlUp).Row).Copy Destination:=ws.Range("B2")

        ' Delete all data in column C and replace with "-"
        ws.Range("C1:C" & ws.Cells(Rows.Count, "C").End(xlUp).Row).Value = "-"

        ' Copy all values from column I starting from I3 to column C starting from C2
        ws.Range("I3:I" & ws.Cells(Rows.Count, "I").End(xlUp).Row).Copy Destination:=ws.Range("C2")

        ' Replace all cells in column C that do not contain "Company Name" with "-"
        For Each cell In ws.Range("C1:C" & ws.Cells(Rows.Count, "C").End(xlUp).Row)
            If InStr(cell.Value, "Company Name") = 0 Then
                cell.Value = "-"
            End If
        Next cell

        ' Find the first cell in column H that contains "ABC"
        Set sourceCell = ws.Columns("H").Find("ABC")

        ' If a cell containing "ABC" is found, copy the cells from that cell to the end of the column to column D starting from D3
        If Not sourceCell Is Nothing Then
            ws.Range(sourceCell, ws.Cells(ws.Rows.Count, "H").End(xlUp)).Copy Destination:=ws.Range("D3")
        End If

        ' Find the first cell in column I that contains "ABC"
        Set sourceCellI = ws.Columns("I").Find("ABC")

        ' If a cell containing "ABC" is found, copy the cells from that cell to the end of the column to column E starting from E3
        If Not sourceCellI Is Nothing Then
            ws.Range(sourceCellI, ws.Cells(ws.Rows.Count, "I").End(xlUp)).Copy Destination:=ws.Range("E3")
        End If

        ' Replace all cells in column D that do not contain "ABC" with "-"
        For Each cell In ws.Range("D1:D" & ws.Cells(Rows.Count, "D").End(xlUp).Row)
            If InStr(cell.Value, "ABC") = 0 Then
                cell.Value = "-"
            End If
        Next cell

        ' Replace all cells in column E that do not contain "ABC" with "-"
        For Each cell In ws.Range("E1:E" & ws.Cells(Rows.Count, "E").End(xlUp).Row)
            If InStr(cell.Value, "ABC") = 0 Then
                cell.Value = "-"
            End If
        Next cell

        ' Delete all data in column G and replace with "-"
        ws.Range("G1:G" & ws.Cells(Rows.Count, "G").End(xlUp).Row).Value = "-"

        ' Delete all data in column H and replace with "-"
        ws.Range("H1:H" & ws.Cells(Rows.Count, "H").End(xlUp).Row).Value = "-"

        ' Find the first cell in column I that contains "ABC"
        Set sourceCellI2 = ws.Columns("I").Find("ABC")

        ' If a cell containing "ABC" is found, copy the cells from that cell to the end of the column to column F starting from F3
        If Not sourceCellI2 Is Nothing Then
            ws.Range(sourceCellI2, ws.Cells(ws.Rows.Count, "I").End(xlUp)).Copy Destination:=ws.Range("F3")
        End If

        ' Resize all the cells to fit the content
        ws.Cells.EntireColumn.AutoFit
        ws.Cells.EntireRow.AutoFit
    Next ws
End Sub
